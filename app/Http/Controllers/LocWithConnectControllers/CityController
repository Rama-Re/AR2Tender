<?php

namespace App\Http\Controllers\Location;

set_time_limit(1000);
use App\Assets\City;
use App\Http\Controllers\Controller;
use Exception;
use Illuminate\Support\Facades\DB;

class CityController extends Controller
{
    public function save()
    {
        if (empty(DB::table('locations')->count())) {
            for ($i = 1; $i < 10; $i++) {
                $cities = City::get_all_city($i);

                foreach ($cities as $key => $value) {
                    $citesarray = [
                        'country_id' => $value['country'],
                        'location_name' => $value['city'],
                    ];
                    DB::table('locations')->insert($citesarray);
                }
                sleep(65);
            }
        } else {
            throw new Exception('the location table has elements');
        }

    }
}